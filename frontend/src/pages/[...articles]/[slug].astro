---
import { Meta } from '~/components/core/MetaTags.astro';
import ArticleLayout from '~/layouts/ArticleLayout.astro';
import { cleanSlug, POST_BASE } from '~/utils/permalinks';
import { fetchPosts, Post } from '~/utils/posts';

export async function getStaticPaths() {
  const posts = await fetchPosts();

  return posts.map((post) => ({
    params: { slug: cleanSlug(post.id), articles: POST_BASE || undefined },
    props: { post },
  }));
}

interface Props {
  post: Post;
}

const { post } = Astro.props;

const meta: Meta = {
  title: post.title,
  description: post.description,
  ogType: 'article',
};
---

<ArticleLayout meta={meta} readingTime={post.readingTime} publishDate={post.publishDate}>
  <post.content />
</ArticleLayout>
